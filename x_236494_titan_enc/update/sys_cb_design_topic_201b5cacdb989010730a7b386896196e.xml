<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="Titan Knowledge Search Clone">2c1b5cacdb989010730a7b386896196a</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"e992ce3893ff4bbdb56e710de91bd3bb","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"e992ce3893ff4bbdb56e710de91bd3bb"}],"goals":[{"name":"Knowledge Search","trigger_id":"e992ce3893ff4bbdb56e710de91bd3bb","nodes":[{"type":"StartGoal","goal_id":"9b157f7c92e54e3c95f31ab19c495962","greeting_msg":{"type":"String","mode":"script","value":"(function execute() {\n    /* Script the string logic here.\n       Be sure to return a quoted string.\n\n       For example:\n\n       var result;\n       var x = 1;\n       if (x == 1) {\n           result = 'hi there';\n       } else {\n           result = 'how are you?';\n       }\n       return result;\n    */\n    return '';\n})()\n"},"id":"eb8737e2a12d41d6b9eebea8a3a147ba","name":"Start","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"TerminateGoal","goal_id":"9b157f7c92e54e3c95f31ab19c495962","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"562f9ab42a0e4946ac67f7d349515f80","name":"End","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"7b2b53b5c04140dbb4c2f382bb228319","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Enter a phrase to search the knowledge base.\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","name":"searchquery","allow_text_input":true,"use_confirmation_prompt":false},"optional":false,"id":"f4b2020022f6467aaa5aa10d68b10236","name":"Search Term","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    /* Uses the searh term inputed by user and calls the Contextual Search using the search context created\n       to return a max of 20 results and stores them JSON string.\n    */\n    var search_term = vaInputs.search_term;\n    //Navigate to Contextual Search &gt; Search Contexts &gt; breadcrumb icon and copy sys_id\n    //paste in search_context_sys_id.\n    var context = vaVars.search_context_sys_id;\n    //var contextualSearch = new sn_itsm_va.VAContextualSearchUtil();\n    var contextualSearch = new global.VAGlobalContextualSearchUtil();\n    var response = contextualSearch.search(context, search_term);\n    var success = contextualSearch.processSearchResponse(response);\n\n    if (!success) {\n        return;\n    }   \n    var relevantSearchResults = contextualSearch.processGeneralResults(response, 20, -2);\n    gs.info('______________________________________________ ');\n    gs.info(JSON.stringify(relevantSearchResults));\n    gs.info('_____________________________________________ ');\n    vaVars.kbResultCount = relevantSearchResults.length;\n    vaVars.search_kb_json_string = JSON.stringify(relevantSearchResults);\n    vaVars.index = 0;\n    return;\n})()\n","id":"bff6b47e9b024be58ad9fa0521669988","name":"Contextual Search","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ReferenceChoiceInputPrompt","mode":"external","id":"14ec6c96cf754045bdd018fabe8e0384","name":"KB Selection","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"},"variable_id":"85948bb6322640e680376984ff48c4f9","message":{"type":"String","mode":"script","value":"(function execute() {\n    if (vaVars.kbResultCount &gt; 0)\n        return gs.getMessage('Alright, how else can I help? Here\\'s what I can do:');\n\n    return gs.getMessage(\"Sorry, I couldn't find anything on that topic. What would you like to do?\");\n})()\n"},"optional":false,"nlu_entity_binding":{"type":"NLUEntityBinding","name":"","allow_text_input":false,"use_confirmation_prompt":true},"expression_mode":"script","script":"(function execute() {\n    /*\n    Pagination buttons for suggested KB articles.\n    */\n    var options = [];\n    var limit = parseInt(vaVars.limit);\n    var index = parseInt(vaVars.index);\n    \n    if (index &gt;= limit) {\n        options.push({ 'value': 'show_prev', 'label': gs.getMessage('Show previous')});    \n    }\n\n    if (index+limit &lt; vaVars.kbResultCount) {\n        options.push({ 'value': 'show_next', 'label': gs.getMessage('Show more')});    \n    }\n    options.push({ 'value': 'new_search', 'label': gs.getMessage('Try a different search')});\n    options.push({ 'value': 'cancel', 'label': gs.getMessage('I\\'m done')});\n    return options;\n})()\n","no_options_found_message":{"type":"String","mode":"string","value":"No Records Found"},"condition":{"type":"Condition","mode":"external_script","value":"(function execute() {\n    /*\n    Pagination buttons for suggested KB articles.\n    */\n    var options = [];\n    var limit = parseInt(vaVars.limit);\n    var index = parseInt(vaVars.index);\n    \n    if (index &gt;= limit) {\n        options.push({ 'value': 'show_prev', 'label': gs.getMessage('Show previous')});    \n    }\n\n    if (index+limit &lt; vaVars.kbResultCount) {\n        options.push({ 'value': 'show_next', 'label': gs.getMessage('Show more')});    \n    }\n    options.push({ 'value': 'new_search', 'label': gs.getMessage('Try a different search')});\n    options.push({ 'value': 'cancel', 'label': gs.getMessage('I\\'m done')});\n    return options;\n})()\n"}},{"type":"Decision","name":"Knowledge Choice Decision","branches":[{"type":"Branch","label":"Cancel","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'cancel';\n})()\n"},"id":"ce2b21b715414590be7a77639b802d87","name":"Cancel"},{"type":"Branch","label":"New Search","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'new_search';\n})()\n"},"id":"7e0cda99a9c34f8ea3d4144bf2619255","name":"New Search"},{"type":"Branch","label":"Show Next","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'show_next';\n})()\n"},"id":"b90881d4838844618e1b8cbe3fe424b1","name":"Show Next"},{"type":"Branch","label":"Show Previous","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'show_prev';\n})()\n"},"id":"7c7da02b255846beae8cd1ad2182b7a5","name":"Show Previous"}],"id":"7235cc953bd44d35b134c0ed4c39bc4c","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    vaVars.index = parseInt(vaVars.index) + parseInt(vaVars.limit);\n    return '';\n})()\n","id":"0c9ea5e155b24cfbadfa8e3d638b577b","name":"Next","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    vaVars.index = parseInt(vaVars.index) - parseInt(vaVars.limit);\n    return '';\n})()\n","id":"f6a131edd74342cb86a446d919397529","name":"Previous","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"No KBs","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return !(vaVars.kbResultCount &gt; 0);\n})()\n"},"id":"d942a84ecaa44366add7563172784345","name":"No KBs"},{"type":"Branch","label":"Found KB(s)","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaVars.kbResultCount &gt; 0;\n})()\n"},"id":"8da69b3d02bc4fd29251a8938a4a0a56","name":"Found KB(s)"}],"id":"f49d87f89b334c33827c8af797e1264a","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Here are the results I found in our Knowledge Base that might help you.\", vaContext.getRequesterLang())"},"id":"04b3006304974dddb306de521216e8ac","name":"Found Result Message","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"LinkOutputPrompt","header":{"type":"String","mode":"script","value":"(function execute() {\n    return '';\n})()\n"},"label":{"type":"String","mode":"string","value":""},"url":{"type":"String","mode":"string","value":""},"link_type":"multiple","multi_link_script":"(function execute(header) {\n\tvar groupedLinksOutMsg = new sn_cs.GroupedPartsOutMsg();\n\tgroupedLinksOutMsg.setHeader(header);\n\tvar limit = parseInt(vaVars.limit);\n\tvar searchJsonObj = JSON.parse(vaVars.search_kb_json_string);\n\tgs.info(\"searchJsonObj \"+vaVars.search_kb_json_string);\n\tvar index = parseInt(vaVars.index);\n\tvar linkBuilder = new global.cxs_SearchResultLinkBuilder();\n\tfor (var i = index; i &lt; index + limit &amp;&amp; i &lt; searchJsonObj.length; i++) {\ngs.info(\"searchJsonObj \"+searchJsonObj[i]);\n\t\tvar link = linkBuilder.build(searchJsonObj[i], vaInputs.portal);\n        if(link.label != undefined &amp;&amp; link.link != undefined &amp;&amp; link.description != undefined &amp;&amp; link.context_label != undefined){\n            groupedLinksOutMsg.addLinkPart(link.label, link.link, link.description, link.context_label);\n\t\t}\n\t\t\n\t}\n\treturn groupedLinksOutMsg;\n})(header)\n","id":"394e47b928ee45b7be090272fc4af429","name":"Display KB(s)","goal_id":"9b157f7c92e54e3c95f31ab19c495962","applicability":{"type":"Applicability","mode":"script","value":"true"}}],"edges":[{"type":"Edge","source_node_id":"04b3006304974dddb306de521216e8ac","target_node_id":"394e47b928ee45b7be090272fc4af429","id":"3e5c068587644140bddd6f7ddc5abac9"},{"type":"Edge","source_node_id":"eb8737e2a12d41d6b9eebea8a3a147ba","target_node_id":"f4b2020022f6467aaa5aa10d68b10236","id":"d34ca7a9f9d54a2095566e28455dbc71"},{"type":"Edge","source_node_id":"f4b2020022f6467aaa5aa10d68b10236","target_node_id":"bff6b47e9b024be58ad9fa0521669988","id":"9af82108daa14b4d94d6c75df80a0d03"},{"type":"Edge","source_node_id":"14ec6c96cf754045bdd018fabe8e0384","target_node_id":"7235cc953bd44d35b134c0ed4c39bc4c","id":"772cacfd325140a1b7a154e88cc12492"},{"type":"Edge","source_node_id":"7235cc953bd44d35b134c0ed4c39bc4c","target_node_id":"562f9ab42a0e4946ac67f7d349515f80","branch_id":"ce2b21b715414590be7a77639b802d87","id":"4d6cef2907bb42e6aa9e71bbb2f2a627","name":"ce2b21b715414590be7a77639b802d87"},{"type":"Edge","source_node_id":"7235cc953bd44d35b134c0ed4c39bc4c","target_node_id":"f4b2020022f6467aaa5aa10d68b10236","branch_id":"7e0cda99a9c34f8ea3d4144bf2619255","id":"5990d9ee612b432992c8f22ec1b3cc3f","name":"7e0cda99a9c34f8ea3d4144bf2619255"},{"type":"Edge","source_node_id":"7235cc953bd44d35b134c0ed4c39bc4c","target_node_id":"0c9ea5e155b24cfbadfa8e3d638b577b","branch_id":"b90881d4838844618e1b8cbe3fe424b1","id":"820e5f7e2ef64dadb88067f1261392d0","name":"b90881d4838844618e1b8cbe3fe424b1"},{"type":"Edge","source_node_id":"0c9ea5e155b24cfbadfa8e3d638b577b","target_node_id":"394e47b928ee45b7be090272fc4af429","id":"e14444bd46f54afb9eaff870ac547bb2"},{"type":"Edge","source_node_id":"7235cc953bd44d35b134c0ed4c39bc4c","target_node_id":"f6a131edd74342cb86a446d919397529","branch_id":"7c7da02b255846beae8cd1ad2182b7a5","id":"0dd17a3f3bd24eeb80bc3974fb4df080","name":"7c7da02b255846beae8cd1ad2182b7a5"},{"type":"Edge","source_node_id":"f6a131edd74342cb86a446d919397529","target_node_id":"394e47b928ee45b7be090272fc4af429","id":"f6006a06bdf4436f8d2c884cb0109561"},{"type":"Edge","source_node_id":"bff6b47e9b024be58ad9fa0521669988","target_node_id":"f49d87f89b334c33827c8af797e1264a","id":"df69d21a1839414bbe536887ed1034ac"},{"type":"Edge","source_node_id":"f49d87f89b334c33827c8af797e1264a","target_node_id":"14ec6c96cf754045bdd018fabe8e0384","branch_id":"d942a84ecaa44366add7563172784345","id":"ce2c6372839644ba804dd15b678c916a","name":"d942a84ecaa44366add7563172784345"},{"type":"Edge","source_node_id":"f49d87f89b334c33827c8af797e1264a","target_node_id":"04b3006304974dddb306de521216e8ac","branch_id":"8da69b3d02bc4fd29251a8938a4a0a56","id":"1ac23592676742ecb0410a929b7ec1c1","name":"8da69b3d02bc4fd29251a8938a4a0a56"},{"type":"Edge","source_node_id":"394e47b928ee45b7be090272fc4af429","target_node_id":"14ec6c96cf754045bdd018fabe8e0384","id":"8fa1afad5d294ce0b3eca35cf2c8dd65"}],"id":"9b157f7c92e54e3c95f31ab19c495962"}],"script_variables":[{"type":"String","name":"search_kb_json_string","id":"59a9a93cd56643c5b7bb4a818c1b3be9"},{"type":"String","name":"index","value":{"type":"String","mode":"script"},"id":"7a31f83ec72a4f24b9e39ed36349a2cc"},{"type":"String","name":"limit","value":{"type":"String","mode":"string","value":"3"},"id":"63a9614e3714473c9d40b3f4b03bdce3"},{"type":"String","name":"search_context_sys_id","value":{"type":"String","mode":"string","value":"5e973112f8455300964f8ada0264c0a5"},"id":"8723b9b789d540e090fc66ab58037196"},{"type":"String","name":"kbResultCount","value":{"type":"String","mode":"string","value":"0"},"id":"dbf250b4a66e48f89150000549aa6cf6"},{"type":"String","name":"LiveAgent_application","value":{"type":"String","mode":"string","value":"itsm"},"id":"0fa6398cd7c04f05867b337607845bfb"}],"glide_variables":[{"type":"String","name":"search_term","id":"7b2b53b5c04140dbb4c2f382bb228319"},{"type":"Choice","choices":[],"id":"85948bb6322640e680376984ff48c4f9","name":"kb_selection","table":""},{"type":"Reference","table":"sys_user","id":"459f819d4657491da54ab84e4b1d6b94","name":"user"}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":[],"scope":"fd74bb58db109010730a7b386896199e","library-usage":{"type":"Library","input-parameters":[],"return-values-mapping":[]},"domain":"global","id":"020bd0acdb989010730a7b3868961925","name":"Titan Knowledge Search Clone","key_phrases":[],"nlu_provider":"64c023c17300330021a044764df6a70e","nlu_model":"","nlu_intent":"","flexible_conversation_switching":true,"design_category":"b28634c4b7b93300da7ab948ee11a93a","library":true}</design_definition>
        <design_topic_id>020bd0acdb989010730a7b3868961925</design_topic_id>
        <name>Titan Knowledge Search Clone</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>pradeep</sys_created_by>
        <sys_created_on>2020-04-17 08:40:32</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>201b5cacdb989010730a7b386896196e</sys_id>
        <sys_mod_count>3</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="Titan Encircle" source="x_236494_titan_enc">fd74bb58db109010730a7b386896199e</sys_package>
        <sys_policy/>
        <sys_scope display_value="Titan Encircle">fd74bb58db109010730a7b386896199e</sys_scope>
        <sys_update_name>sys_cb_design_topic_201b5cacdb989010730a7b386896196e</sys_update_name>
        <sys_updated_by>neel</sys_updated_by>
        <sys_updated_on>2020-05-05 03:15:40</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
