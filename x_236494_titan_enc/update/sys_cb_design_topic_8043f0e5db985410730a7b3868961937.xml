<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="TE Support Demo">c843f0e5db985410730a7b3868961932</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"469984dcffd842dcac16049abb43c638","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"469984dcffd842dcac16049abb43c638"}],"goals":[{"name":"primary","trigger_id":"469984dcffd842dcac16049abb43c638","nodes":[{"type":"StartGoal","goal_id":"07e5b7836c014c13a116737511e2ff01","greeting_msg":{"type":"String","mode":"string","value":""},"id":"c226061e4a1f41edba8e2a73735aed9c","name":"Start"},{"type":"TerminateGoal","goal_id":"07e5b7836c014c13a116737511e2ff01","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"99004541594340418dba35917e68b965","name":"End"},{"type":"InputPrompt","variable_id":"5df6c0aa76634251a16ef468b6c431bd","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Hello! I am your the Encircle assistant. How can I help you today?\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","name":"Encircle Brands","allow_text_input":true,"use_confirmation_prompt":true,"label":"Encircle Brands"},"optional":false,"id":"5b208521792743a48b926d82b29baaef","name":"Greeting","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    /* Uses the searh term inputed by user and calls the Contextual Search using the search context created\n       to return a max of 20 results and stores them JSON string.\n    */\n    var search_term = vaInputs.greeting;\n    //Navigate to Contextual Search &gt; Search Contexts &gt; breadcrumb icon and copy sys_id\n    //paste in search_context_sys_id.\n    var context = vaVars.search_context_sys_id;\n    //var contextualSearch = new sn_itsm_va.VAContextualSearchUtil();\n    var contextualSearch = new global.VAGlobalContextualSearchUtil();\n    var response = contextualSearch.search(context, search_term);\n    var success = contextualSearch.processSearchResponse(response);\n    if (!success) {\n        return;\n    }   \n    var relevantSearchResults = contextualSearch.processGeneralResults(response, 20, -2);\n    vaVars.kbResultCount = relevantSearchResults.length;\n    vaVars.search_kb_json_string = JSON.stringify(relevantSearchResults);\n    vaVars.index = 0;\n    return;\n})()\n","id":"6c820196ceed41f8a9795a85902bf9fd","name":"Contextual Search","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"No KBs","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return !(vaVars.kbResultCount &gt; 0);\n})()\n"},"id":"7b5439e771b54d3ba0b27f9f1914e79a","name":"No KBs"},{"type":"Branch","label":"Found KB(s)","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaVars.kbResultCount &gt; 0;\n})()\n"},"id":"262e73c187244c978baeeeb5d810c543","name":"Found KB(s)"}],"id":"65308f5a72344674991b356391b286a2","goal_id":"07e5b7836c014c13a116737511e2ff01"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Here are the results I found in our Knowledge Base that might help you.\", vaContext.getRequesterLang())"},"id":"49c15883a496400084a68062a28d87cc","name":"Found Result Message","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"LinkOutputPrompt","header":{"type":"String","mode":"script","value":"(function execute() {\n    return '';\n})()\n"},"label":{"type":"String","mode":"string","value":""},"url":{"type":"String","mode":"string","value":""},"link_type":"multiple","multi_link_script":"(function execute(header) {\n\tvar groupedLinksOutMsg = new sn_cs.GroupedPartsOutMsg();\n\tgroupedLinksOutMsg.setHeader(header);\n\tvar limit = parseInt(vaVars.limit);\n\tvar searchJsonObj = JSON.parse(vaVars.search_kb_json_string);\n\tvar index = parseInt(vaVars.index);\n    gs.info(\"search Json Obj\"+vaVars.search_kb_json_string);\n\tvar linkBuilder = new global.cxs_SearchResultLinkBuilder();\n\tfor (var i = index; i &lt; index + limit &amp;&amp; i &lt; searchJsonObj.length; i++) {\n\t\tvar link = linkBuilder.build(searchJsonObj[i], vaInputs.portal);\n\t\t//groupedLinksOutMsg.addLinkPart(link.label, link.link, link.description, link.context_label);\n\t    if(link.label != undefined &amp;&amp; link.link != undefined &amp;&amp; link.description != undefined &amp;&amp; link.context_label != undefined){\n            var result = searchJsonObj[i].id.split(\":\");\n\t\t\tif(result &amp;&amp; result[0] == 'kb_social_qa_question') {\n                link.link = 'titancom?id=community_question&amp;sys_id='+result[1]; \n\t\t\t\t//gs.info('link__q '+link.link);\n\t\t\t\n\t\t\t} else if(result &amp;&amp; result[0] == 'kb_knowledge') {\n                link.link = 'titancom?id=kb_article_view&amp;sys_kb_id='+result[1]; \n\t\t\t\t//gs.info('link__k '+link.link);\n\n\t\t\t} else {\n\n\t\t\t}\n\t\t\tgroupedLinksOutMsg.addLinkPart(link.label, link.link, link.description, link.context_label);\t\t\t\n\t\t}\n\t}\n\treturn groupedLinksOutMsg;\n})(header)\n","id":"c2fee22bddaf461db8868600abb5c496","name":"Display KB(s)","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ReferenceChoiceInputPrompt","mode":"external","id":"dca4e0645ee54da98b62ccfd06244377","name":"KB Selection","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"},"variable_id":"6a2a55b9377a4df382805c0179afe999","message":{"type":"String","mode":"script","value":"(function execute() {\n    if (vaVars.kbResultCount &gt; 0)\n        return gs.getMessage('Was this helpful?');\n\n    return gs.getMessage(\"Sorry, I couldn't find anything on that topic. What would you like to do?\");\n})()\n"},"optional":false,"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":false},"expression_mode":"script","script":"(function execute() {\n    /*\n    Pagination buttons for suggested KB articles.\n    */\n    var options = [];\n    var limit = parseInt(vaVars.limit);\n    var index = parseInt(vaVars.index);\n    \n    if (index &gt;= limit) {\n        options.push({ 'value': 'show_prev', 'label': gs.getMessage('Show previous')});    \n    }\n\n    if (index+limit &lt; vaVars.kbResultCount) {\n        options.push({ 'value': 'show_next', 'label': gs.getMessage('Show more')});    \n    }\n    //options.push({ 'value': 'usefull_yes', 'label': gs.getMessage('Yes, this was useful')});    \n    options.push({ 'value': 'new_search', 'label': gs.getMessage('Search for more articles')});\n    //options.push({ 'value': 'cancel', 'label': gs.getMessage('I\\'m done')});\n    options.push({ 'value': 'need_support', 'label': gs.getMessage('I need support')});    \n    return options;\n})()\n","no_options_found_message":{"type":"String","mode":"string","value":"No Records Found"},"condition":{"type":"Condition","mode":"external_script","value":"(function execute() {\n    /*\n    Pagination buttons for suggested KB articles.\n    */\n    var options = [];\n    var limit = parseInt(vaVars.limit);\n    var index = parseInt(vaVars.index);\n    \n    if (index &gt;= limit) {\n        options.push({ 'value': 'show_prev', 'label': gs.getMessage('Show previous')});    \n    }\n\n    if (index+limit &lt; vaVars.kbResultCount) {\n        options.push({ 'value': 'show_next', 'label': gs.getMessage('Show more')});    \n    }\n    //options.push({ 'value': 'usefull_yes', 'label': gs.getMessage('Yes, this was useful')});    \n    options.push({ 'value': 'new_search', 'label': gs.getMessage('Search for more articles')});\n    //options.push({ 'value': 'cancel', 'label': gs.getMessage('I\\'m done')});\n    options.push({ 'value': 'need_support', 'label': gs.getMessage('I need support')});    \n    return options;\n})()\n"}},{"type":"Decision","name":"Knowledge Choice Decision","branches":[{"type":"Branch","label":"New Search","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'new_search';\n})()\n"},"id":"4d87ceef801947a397d3810fe8cd9643","name":"New Search"},{"type":"Branch","label":"Cancel","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'cancel';\n})()\n"},"id":"426a83c3113c467abdd638a225846e03","name":"Cancel"},{"type":"Branch","label":"Show Previous","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'show_prev';\n})()\n"},"id":"7d7e85ada1f34250974947aa7a209448","name":"Show Previous"},{"type":"Branch","label":"Show Next","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'show_next';\n})()\n"},"id":"c707b0d9515e4b7d9ff8dc1282000760","name":"Show Next"},{"type":"Branch","label":"Need Support","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'need_support';\n})()\n"},"id":"3912ea9801714d1a90822c73877f82c7","name":"Need Support"}],"id":"d5a68e74c7414e85b8b49b1f73d6e7e2","goal_id":"07e5b7836c014c13a116737511e2ff01"},{"type":"ScriptedAction","script":"(function execute() {\n    vaVars.index = parseInt(vaVars.index) - parseInt(vaVars.limit);\n    return '';\n})()\n","id":"f12bc9353fd549268f82b44acc92a2cf","name":"Previous","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    vaVars.index = parseInt(vaVars.index) + parseInt(vaVars.limit);\n    return '';\n})()\n","id":"23bb3926a1fb4d4f85ca97b20fdd8ffe","name":"Next","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ChoiceInputPrompt","expression_mode":"simple","id":"3ff76700520640cbbb181f929e09504c","name":"Support Options","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"},"variable_id":"2b0d3a49252b4940a19d49826dcccc52","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Please selection your action\", vaContext.getRequesterLang())"},"optional":false,"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":false}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Speak to a live agent","expression":{"type":"Applicability","mode":"query","value":"support_options=Speak to a live agent"},"id":"6b034a4ea3c84383b3918ef4f22c3e1f","name":"Speak to a live agent"},{"type":"Branch","label":"Raise a support case","expression":{"type":"Applicability","mode":"query","value":"support_options=Raise a support case"},"id":"b6ee044e837e478ebf211e67acb6039b","name":"Raise a support case"}],"id":"2afff1f342324258a7e4c739c993e6ce","goal_id":"07e5b7836c014c13a116737511e2ff01"},{"type":"ScriptedAction","script":"(function execute() {\n    if(vaSystem.isLiveAgentAvailable()) { \n        vaSystem.connectToAgent();\n    }\n    })()","id":"c9741595c6cd493a8a02737ca5c01296","name":"Connect to Agent","goal_id":"07e5b7836c014c13a116737511e2ff01","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"LibraryCall","library_topic_name":"Titan Create Case Clone","library_topic_id":"76ba5c2cdb989010730a7b3868961914","parameter-mappings":[],"return-value-mappings":[],"id":"f864bc7d3ef04212bf25ee923022238e","name":"Titan Create Case Clone","goal_id":"07e5b7836c014c13a116737511e2ff01"}],"edges":[{"type":"Edge","source_node_id":"d5a68e74c7414e85b8b49b1f73d6e7e2","target_node_id":"5b208521792743a48b926d82b29baaef","branch_id":"4d87ceef801947a397d3810fe8cd9643","id":"4eee404e47d9421b805c7e1b13a28a37","name":"4d87ceef801947a397d3810fe8cd9643"},{"type":"Edge","source_node_id":"5b208521792743a48b926d82b29baaef","target_node_id":"6c820196ceed41f8a9795a85902bf9fd","id":"0f3b764d4ce3487da7fa4e6d45ab3807"},{"type":"Edge","source_node_id":"c226061e4a1f41edba8e2a73735aed9c","target_node_id":"5b208521792743a48b926d82b29baaef","id":"a0440b82f7564badaadc18b6ebfb5adf"},{"type":"Edge","source_node_id":"6c820196ceed41f8a9795a85902bf9fd","target_node_id":"65308f5a72344674991b356391b286a2","id":"070101030faa4225856c0315699f21c8"},{"type":"Edge","source_node_id":"65308f5a72344674991b356391b286a2","target_node_id":"dca4e0645ee54da98b62ccfd06244377","branch_id":"7b5439e771b54d3ba0b27f9f1914e79a","id":"2ec549f0466f4cb4a71ecf1b391003d9","name":"7b5439e771b54d3ba0b27f9f1914e79a"},{"type":"Edge","source_node_id":"65308f5a72344674991b356391b286a2","target_node_id":"49c15883a496400084a68062a28d87cc","branch_id":"262e73c187244c978baeeeb5d810c543","id":"d907e80ba8824420aee9e1af5816324c","name":"262e73c187244c978baeeeb5d810c543"},{"type":"Edge","source_node_id":"49c15883a496400084a68062a28d87cc","target_node_id":"c2fee22bddaf461db8868600abb5c496","id":"bbc004f2a90d462297beccbfa86bc0ce"},{"type":"Edge","source_node_id":"c2fee22bddaf461db8868600abb5c496","target_node_id":"dca4e0645ee54da98b62ccfd06244377","id":"d561093ee67d45ae8657f5864ef0883c"},{"type":"Edge","source_node_id":"dca4e0645ee54da98b62ccfd06244377","target_node_id":"d5a68e74c7414e85b8b49b1f73d6e7e2","id":"b673c8060e794e49a8d69540dfc7d31c"},{"type":"Edge","source_node_id":"d5a68e74c7414e85b8b49b1f73d6e7e2","target_node_id":"99004541594340418dba35917e68b965","branch_id":"426a83c3113c467abdd638a225846e03","id":"17a11f85e00546fb8d59a2ee9868169d","name":"426a83c3113c467abdd638a225846e03"},{"type":"Edge","source_node_id":"d5a68e74c7414e85b8b49b1f73d6e7e2","target_node_id":"f12bc9353fd549268f82b44acc92a2cf","branch_id":"7d7e85ada1f34250974947aa7a209448","id":"f60593bb6c114ed98d932b7100cb236c","name":"7d7e85ada1f34250974947aa7a209448"},{"type":"Edge","source_node_id":"f12bc9353fd549268f82b44acc92a2cf","target_node_id":"c2fee22bddaf461db8868600abb5c496","id":"58ec747250e041e2981e40176ef70562"},{"type":"Edge","source_node_id":"d5a68e74c7414e85b8b49b1f73d6e7e2","target_node_id":"23bb3926a1fb4d4f85ca97b20fdd8ffe","branch_id":"c707b0d9515e4b7d9ff8dc1282000760","id":"e771133887a64cfca3509c5ec63c072d","name":"c707b0d9515e4b7d9ff8dc1282000760"},{"type":"Edge","source_node_id":"23bb3926a1fb4d4f85ca97b20fdd8ffe","target_node_id":"c2fee22bddaf461db8868600abb5c496","id":"046ff8dc5d2040c6b88d37062f80d4a8"},{"type":"Edge","source_node_id":"d5a68e74c7414e85b8b49b1f73d6e7e2","target_node_id":"3ff76700520640cbbb181f929e09504c","branch_id":"3912ea9801714d1a90822c73877f82c7","id":"4eeefec2fc1241c8833554487249a6ec","name":"3912ea9801714d1a90822c73877f82c7"},{"type":"Edge","source_node_id":"3ff76700520640cbbb181f929e09504c","target_node_id":"2afff1f342324258a7e4c739c993e6ce","id":"df446d8d0cc84208bb6242f79b40f5d0"},{"type":"Edge","source_node_id":"2afff1f342324258a7e4c739c993e6ce","target_node_id":"c9741595c6cd493a8a02737ca5c01296","branch_id":"6b034a4ea3c84383b3918ef4f22c3e1f","id":"22e77ef1d5c54b47bacf213c918e780c","name":"6b034a4ea3c84383b3918ef4f22c3e1f"},{"type":"Edge","source_node_id":"c9741595c6cd493a8a02737ca5c01296","target_node_id":"99004541594340418dba35917e68b965","id":"94566b5acc58489eb8c9758d52f98010"},{"type":"Edge","source_node_id":"2afff1f342324258a7e4c739c993e6ce","target_node_id":"f864bc7d3ef04212bf25ee923022238e","branch_id":"b6ee044e837e478ebf211e67acb6039b","id":"db2581467c264bcb98eb30f45abc1bda","name":"b6ee044e837e478ebf211e67acb6039b"},{"type":"Edge","source_node_id":"f864bc7d3ef04212bf25ee923022238e","target_node_id":"99004541594340418dba35917e68b965","id":"48dd4b0673a6413ba4d70c86b35a76a6"}],"id":"07e5b7836c014c13a116737511e2ff01"}],"script_variables":[{"type":"String","name":"search_context_sys_id","value":{"type":"String","mode":"string","value":"5e973112f8455300964f8ada0264c0a5"},"id":"1b8d35396f97495ead2e89ce7275e4f4"},{"type":"String","name":"search_kb_json_string","value":{"type":"String","mode":"string"},"id":"49c57495ee7d4317bd758c67ad84d2b9"},{"type":"String","name":"index","value":{"type":"String","mode":"string"},"id":"f7fb0d51a3b1466db0d5b2ec0a898e47"},{"type":"String","name":"limit","value":{"type":"String","mode":"string","value":"3"},"id":"c4be8552f6a645068a7c04ef187a410c"},{"type":"String","name":"kbResultCount","value":{"type":"String","mode":"string","value":"0"},"id":"6717fdcc040a41b49cf9664e94295d1c"}],"glide_variables":[{"type":"String","name":"created_incident_sys_id","id":"42ae3a36e55a4aabbe437568c3806c2e"},{"type":"Reference","table":"sys_user","id":"ed8e025ed667430f9786b6626bcbe560","name":"user"},{"type":"String","name":"greeting","id":"5df6c0aa76634251a16ef468b6c431bd"},{"type":"Choice","choices":[],"id":"6a2a55b9377a4df382805c0179afe999","name":"kb_selection","table":""},{"type":"Choice","choices":[{"name":"Raise a support case","element":"Raise a support case"},{"name":"Speak to a live agent","element":"Speak to a live agent"}],"id":"2b0d3a49252b4940a19d49826dcccc52","name":"support_options"}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":["public"],"scope":"fd74bb58db109010730a7b386896199e","domain":"global","id":"d092a8a1db585410730a7b38689619a2","name":"TE Support Demo","key_phrases":["Email Setup","email","mail","mailbox","access","setup","setup email","email on my phone","email on my computer","setup outlook","set up my web mail","configure email"],"nlu_provider":"64c023c17300330021a044764df6a70e","nlu_model":"global_fd74bb58db109010730a7b386896199e_Titan_Encircle_NLU_for_VA","nlu_model_label":"Titan Encircle NLU for VA","nlu_intent":"Knowledge Search","nlu_intent_label":"Knowledge Search","flexible_conversation_switching":false,"design_category":"5628e7f27373230025d032e954f6a7de","library":false}</design_definition>
        <design_topic_id>d092a8a1db585410730a7b38689619a2</design_topic_id>
        <name>TE Support Demo</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>pradeep</sys_created_by>
        <sys_created_on>2020-04-20 13:00:07</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>8043f0e5db985410730a7b3868961937</sys_id>
        <sys_mod_count>13</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="Titan Encircle" source="x_236494_titan_enc">fd74bb58db109010730a7b386896199e</sys_package>
        <sys_policy/>
        <sys_scope display_value="Titan Encircle">fd74bb58db109010730a7b386896199e</sys_scope>
        <sys_update_name>sys_cb_design_topic_8043f0e5db985410730a7b3868961937</sys_update_name>
        <sys_updated_by>pradeep</sys_updated_by>
        <sys_updated_on>2020-05-05 04:35:26</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
