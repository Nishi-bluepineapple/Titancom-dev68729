<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="Knowledge Search">abb41689db941410730a7b3868961913</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"40345e71c91848028ce774bb95ce04f2","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"40345e71c91848028ce774bb95ce04f2"}],"goals":[{"name":"Knowledge Search","trigger_id":"40345e71c91848028ce774bb95ce04f2","nodes":[{"type":"StartGoal","goal_id":"572a43298b1c470994e8e1dce18d7dd2","greeting_msg":{"type":"String","mode":"script","value":"(function execute() {\n    /* Script the string logic here.\n       Be sure to return a quoted string.\n\n       For example:\n\n       var result;\n       var x = 1;\n       if (x == 1) {\n           result = 'hi there';\n       } else {\n           result = 'how are you?';\n       }\n       return result;\n    */\n    return '';\n})()\n"},"id":"0d0181a99ea14144b82f084fe3d4d4bd","name":"Start","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"TerminateGoal","goal_id":"572a43298b1c470994e8e1dce18d7dd2","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"96cef9eee61a4fb8925d6c833833eca9","name":"End","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"9c074716ddc345b38b0c4417d1b20018","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Enter a phrase to search the knowledge base.\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","name":"searchquery","allow_text_input":true,"use_confirmation_prompt":false},"optional":false,"id":"63f26701973541faa3eb17ce96f31965","name":"Search Term","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    /* Uses the searh term inputed by user and calls the Contextual Search using the search context created\n       to return a max of 20 results and stores them JSON string.\n    */\n    var search_term = vaInputs.search_term;\n    //Navigate to Contextual Search &gt; Search Contexts &gt; breadcrumb icon and copy sys_id\n    //paste in search_context_sys_id.\n    var context = vaVars.search_context_sys_id;\n    //var contextualSearch = new sn_itsm_va.VAContextualSearchUtil();\n    var contextualSearch = new global.VAGlobalContextualSearchUtil();\n    var response = contextualSearch.search(context, search_term);\n    var success = contextualSearch.processSearchResponse(response);\n    if (!success) {\n        return;\n    }   \n    var relevantSearchResults = contextualSearch.processGeneralResults(response, 20, -2);\n    vaVars.kbResultCount = relevantSearchResults.length;\n    vaVars.search_kb_json_string = JSON.stringify(relevantSearchResults);\n    vaVars.index = 0;\n    return;\n})()\n","id":"577a2d88f2b1499d98b58bcbe881f2ac","name":"Contextual Search","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ReferenceChoiceInputPrompt","mode":"external","id":"b95925666ec44cb788e01e5a83ba3df3","name":"KB Selection","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"},"variable_id":"949fa9cb8cb349369865f0bb5c4db941","message":{"type":"String","mode":"script","value":"(function execute() {\n    if (vaVars.kbResultCount &gt; 0)\n        return gs.getMessage('Alright, how else can I help? Here\\'s what I can do:');\n\n    return gs.getMessage(\"Sorry, I couldn't find anything on that topic. What would you like to do?\");\n})()\n"},"optional":false,"nlu_entity_binding":{"type":"NLUEntityBinding","name":"","allow_text_input":false,"use_confirmation_prompt":true},"expression_mode":"script","script":"(function execute() {\n    /*\n    Pagination buttons for suggested KB articles.\n    */\n    var options = [];\n    var limit = parseInt(vaVars.limit);\n    var index = parseInt(vaVars.index);\n    \n    if (index &gt;= limit) {\n        options.push({ 'value': 'show_prev', 'label': gs.getMessage('Show previous')});    \n    }\n\n    if (index+limit &lt; vaVars.kbResultCount) {\n        options.push({ 'value': 'show_next', 'label': gs.getMessage('Show more')});    \n    }\n    options.push({ 'value': 'new_search', 'label': gs.getMessage('Try a different search')});\n    options.push({ 'value': 'cancel', 'label': gs.getMessage('I\\'m done')});\n    return options;\n})()\n","no_options_found_message":{"type":"String","mode":"string","value":"No Records Found"},"condition":{"type":"Condition","mode":"external_script","value":"(function execute() {\n    /*\n    Pagination buttons for suggested KB articles.\n    */\n    var options = [];\n    var limit = parseInt(vaVars.limit);\n    var index = parseInt(vaVars.index);\n    \n    if (index &gt;= limit) {\n        options.push({ 'value': 'show_prev', 'label': gs.getMessage('Show previous')});    \n    }\n\n    if (index+limit &lt; vaVars.kbResultCount) {\n        options.push({ 'value': 'show_next', 'label': gs.getMessage('Show more')});    \n    }\n    options.push({ 'value': 'new_search', 'label': gs.getMessage('Try a different search')});\n    options.push({ 'value': 'cancel', 'label': gs.getMessage('I\\'m done')});\n    return options;\n})()\n"}},{"type":"Decision","name":"Knowledge Choice Decision","branches":[{"type":"Branch","label":"Cancel","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'cancel';\n})()\n"},"id":"9319f9b767a44667baea0764f1c09ba5","name":"Cancel"},{"type":"Branch","label":"New Search","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'new_search';\n})()\n"},"id":"6aa11d35d5b244a596c5569fb47d9260","name":"New Search"},{"type":"Branch","label":"Show Next","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'show_next';\n})()\n"},"id":"1809f273378e4adda465319956a5cbb3","name":"Show Next"},{"type":"Branch","label":"Show Previous","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaInputs.kb_selection == 'show_prev';\n})()\n"},"id":"61a7dd76bcd84957b9abd554c3f2e2be","name":"Show Previous"}],"id":"2d2e5652c0d04e199f5a9f799451fbe6","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    vaVars.index = parseInt(vaVars.index) + parseInt(vaVars.limit);\n    return '';\n})()\n","id":"669655aabf8b41468724551b32e1cd91","name":"Next","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n    vaVars.index = parseInt(vaVars.index) - parseInt(vaVars.limit);\n    return '';\n})()\n","id":"2e0ae713a97149c6bf3abb104886d221","name":"Previous","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"No KBs","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return !(vaVars.kbResultCount &gt; 0);\n})()\n"},"id":"a812ef3d529940a0a1af6f22dde7dafd","name":"No KBs"},{"type":"Branch","label":"Found KB(s)","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return vaVars.kbResultCount &gt; 0;\n})()\n"},"id":"ead199d9a3c641ed8053ea64284eb15f","name":"Found KB(s)"}],"id":"1dc6c17779b640e7baabe718c7b799fd","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Here are the results I found in our Knowledge Base that might help you.\", vaContext.getRequesterLang())"},"id":"1ac02349f6294c6dad56577f1f6f4c07","name":"Found Result Message","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"LinkOutputPrompt","header":{"type":"String","mode":"script","value":"(function execute() {\n    return '';\n})()\n"},"label":{"type":"String","mode":"string","value":""},"url":{"type":"String","mode":"string","value":""},"link_type":"multiple","multi_link_script":"(function execute(header) {\n\tvar groupedLinksOutMsg = new sn_cs.GroupedPartsOutMsg();\n\tgroupedLinksOutMsg.setHeader(header);\n\tvar limit = parseInt(vaVars.limit);\n\tvar searchJsonObj = JSON.parse(vaVars.search_kb_json_string);\n\tvar index = parseInt(vaVars.index);\n\n\tvar linkBuilder = new global.cxs_SearchResultLinkBuilder();\n\tfor (var i = index; i &lt; index + limit &amp;&amp; i &lt; searchJsonObj.length; i++) {\n\t\tvar link = linkBuilder.build(searchJsonObj[i], vaInputs.portal);\n\t\t//groupedLinksOutMsg.addLinkPart(link.label, link.link, link.description, link.context_label);\n\t    if(link.label != undefined &amp;&amp; link.link != undefined &amp;&amp; link.description != undefined &amp;&amp; link.context_label != undefined){\n            groupedLinksOutMsg.addLinkPart(link.label, link.link, link.description, link.context_label);\n\t\t}\n\t}\n\treturn groupedLinksOutMsg;\n})(header)\n","id":"cd33100f206a450098d0957aebd8874e","name":"Display KB(s)","goal_id":"572a43298b1c470994e8e1dce18d7dd2","applicability":{"type":"Applicability","mode":"script","value":"true"}}],"edges":[{"type":"Edge","source_node_id":"1ac02349f6294c6dad56577f1f6f4c07","target_node_id":"cd33100f206a450098d0957aebd8874e","id":"2edb8f40a35a48efa77a35610ffbfa16"},{"type":"Edge","source_node_id":"0d0181a99ea14144b82f084fe3d4d4bd","target_node_id":"63f26701973541faa3eb17ce96f31965","id":"6fb2925a32234182aafea2259120aefb"},{"type":"Edge","source_node_id":"63f26701973541faa3eb17ce96f31965","target_node_id":"577a2d88f2b1499d98b58bcbe881f2ac","id":"bd14a789d2444bf3a84568af7c4abcf7"},{"type":"Edge","source_node_id":"b95925666ec44cb788e01e5a83ba3df3","target_node_id":"2d2e5652c0d04e199f5a9f799451fbe6","id":"828664492e9c4d64b1161a995c474bb1"},{"type":"Edge","source_node_id":"2d2e5652c0d04e199f5a9f799451fbe6","target_node_id":"96cef9eee61a4fb8925d6c833833eca9","branch_id":"9319f9b767a44667baea0764f1c09ba5","id":"ca3f59a16e264c09bc4edaa8cb17cd0e","name":"9319f9b767a44667baea0764f1c09ba5"},{"type":"Edge","source_node_id":"2d2e5652c0d04e199f5a9f799451fbe6","target_node_id":"63f26701973541faa3eb17ce96f31965","branch_id":"6aa11d35d5b244a596c5569fb47d9260","id":"04dcaf21d1ae4a20b8d96e78cd10f0ba","name":"6aa11d35d5b244a596c5569fb47d9260"},{"type":"Edge","source_node_id":"2d2e5652c0d04e199f5a9f799451fbe6","target_node_id":"669655aabf8b41468724551b32e1cd91","branch_id":"1809f273378e4adda465319956a5cbb3","id":"940f4585009b4dffbd47e560796152e7","name":"1809f273378e4adda465319956a5cbb3"},{"type":"Edge","source_node_id":"669655aabf8b41468724551b32e1cd91","target_node_id":"cd33100f206a450098d0957aebd8874e","id":"a8970f51ff374969b6c4912d19832a15"},{"type":"Edge","source_node_id":"2d2e5652c0d04e199f5a9f799451fbe6","target_node_id":"2e0ae713a97149c6bf3abb104886d221","branch_id":"61a7dd76bcd84957b9abd554c3f2e2be","id":"d3db175c37064e6cabe034a1d9fdf597","name":"61a7dd76bcd84957b9abd554c3f2e2be"},{"type":"Edge","source_node_id":"2e0ae713a97149c6bf3abb104886d221","target_node_id":"cd33100f206a450098d0957aebd8874e","id":"d814cc19f9c34ad693bd9b9294f2ded8"},{"type":"Edge","source_node_id":"577a2d88f2b1499d98b58bcbe881f2ac","target_node_id":"1dc6c17779b640e7baabe718c7b799fd","id":"04397fec3c974ea5829d6f96ce247c6c"},{"type":"Edge","source_node_id":"1dc6c17779b640e7baabe718c7b799fd","target_node_id":"b95925666ec44cb788e01e5a83ba3df3","branch_id":"a812ef3d529940a0a1af6f22dde7dafd","id":"5df1f590fbd14fa792a6f19c38a746a9","name":"a812ef3d529940a0a1af6f22dde7dafd"},{"type":"Edge","source_node_id":"1dc6c17779b640e7baabe718c7b799fd","target_node_id":"1ac02349f6294c6dad56577f1f6f4c07","branch_id":"ead199d9a3c641ed8053ea64284eb15f","id":"b259a56dd2ad416a983a94398bb36fac","name":"ead199d9a3c641ed8053ea64284eb15f"},{"type":"Edge","source_node_id":"cd33100f206a450098d0957aebd8874e","target_node_id":"b95925666ec44cb788e01e5a83ba3df3","id":"ca17c0c981b44c15ad8237e4b7cc5654"}],"id":"572a43298b1c470994e8e1dce18d7dd2"}],"script_variables":[{"type":"String","name":"search_kb_json_string","id":"7b7544f715104918b23c33d93dcef7d7"},{"type":"String","name":"index","value":{"type":"String","mode":"script"},"id":"136b1c66a5e243e5b7c9fa6e14161ed8"},{"type":"String","name":"limit","value":{"type":"String","mode":"string","value":"3"},"id":"5a0ca16109154c6ca6eb34338529e324"},{"type":"String","name":"search_context_sys_id","value":{"type":"String","mode":"string","value":"5e973112f8455300964f8ada0264c0a5"},"id":"0ace0c05729b4c7584b41d5511e0d249"},{"type":"String","name":"kbResultCount","value":{"type":"String","mode":"string","value":"0"},"id":"c0ddd4acf0534eb28f7a447acbb88efc"},{"type":"String","name":"LiveAgent_application","value":{"type":"String","mode":"string","value":"itsm"},"id":"c2623a31c2b048df904ba8b439521244"}],"glide_variables":[{"type":"String","name":"search_term","id":"9c074716ddc345b38b0c4417d1b20018"},{"type":"Choice","choices":[],"id":"949fa9cb8cb349369865f0bb5c4db941","name":"kb_selection","table":""},{"type":"Reference","table":"sys_user","id":"e6e9b26b74bd4232a795b7352e616282","name":"user"}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":[],"scope":"fd74bb58db109010730a7b386896199e","domain":"global","id":"64045649db941410730a7b386896192e","name":"Knowledge Search","key_phrases":["knowledge"," question"," kb"," article"," search"," how"],"nlu_provider":"64c023c17300330021a044764df6a70e","nlu_model":"global_fd74bb58db109010730a7b386896199e_Titan_Encircle_NLU_for_VA","nlu_model_label":"Titan Encircle NLU for VA","nlu_intent":"Knowledge Search","nlu_intent_label":"Knowledge Search","flexible_conversation_switching":false,"design_category":"b28634c4b7b93300da7ab948ee11a93a","library":false}</design_definition>
        <design_topic_id>64045649db941410730a7b386896192e</design_topic_id>
        <name>Knowledge Search</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>pradeep</sys_created_by>
        <sys_created_on>2020-04-19 06:49:06</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>63b41689db941410730a7b3868961917</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>Knowledge Search</sys_name>
        <sys_package display_value="Titan Encircle" source="x_236494_titan_enc">fd74bb58db109010730a7b386896199e</sys_package>
        <sys_policy/>
        <sys_scope display_value="Titan Encircle">fd74bb58db109010730a7b386896199e</sys_scope>
        <sys_update_name>sys_cb_design_topic_63b41689db941410730a7b3868961917</sys_update_name>
        <sys_updated_by>pradeep</sys_updated_by>
        <sys_updated_on>2020-04-19 08:40:20</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
